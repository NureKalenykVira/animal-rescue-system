<app-site-header></app-site-header>

<main class="page-content user-profile-container">
  <section class="profile-section profile-info-row">
    <div class="profile-photo-side">
      <div class="photo-wrapper">
        <img [src]="user.photoUrl || 'assets/img/user-icon.png'" alt="–§–æ—Ç–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞" />
        <button class="upload-btn">–ó–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏/–∑–º—ñ–Ω–∏—Ç–∏ —Ñ–æ—Ç–æ</button>
      </div>
    </div>

    <form [formGroup]="profileForm" class="profile-form" (ngSubmit)="saveChanges()">
      <h1>–ú—ñ–π –ø—Ä–æ—Ñ—ñ–ª—å</h1>

      <label>
        –Ü–º‚Äô—è
        <input type="text" formControlName="name" [disabled]="!isEditing" />
        <span class="error" *ngIf="name.invalid && name.touched">–Ü–º‚Äô—è –æ–±–æ–≤‚Äô—è–∑–∫–æ–≤–µ</span>
      </label>

      <label>
        –Ü–º‚Äô—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
        <input type="text" [value]="user.username" disabled />
      </label>

      <label>
        Email
        <input type="email" formControlName="email" [disabled]="!isEditing" />
        <span class="error" *ngIf="email.invalid && email.touched">–ù–µ–≤–∞–ª—ñ–¥–Ω–∏–π email</span>
      </label>

      <label>
        –†–æ–ª—å
        <input type="text" [value]="role" disabled />
      </label>

      <a class="doyouwannabe" href="#">–°—Ç–∞—Ç–∏ –≤–æ–ª–æ–Ω—Ç–µ—Ä–æ–º?</a>

      <label>
        –ü–∞—Ä–æ–ª—å
        <input type="password" formControlName="password" [disabled]="!isEditing" />
        <span class="error" *ngIf="password.invalid && password.touched">–ú—ñ–Ω—ñ–º—É–º 6 —Å–∏–º–≤–æ–ª—ñ–≤</span>
      </label>

      <div class="form-buttons">
        <button *ngIf="!isEditing" class="green" type="button" (click)="startEdit()">–ó–º—ñ–Ω–∏—Ç–∏</button>
        <button *ngIf="isEditing" class="grey" type="submit">–ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏</button>
      </div>
    </form>

    <div class="modal-overlay" *ngIf="showPasswordChange">
  <div class="modal-content">
    <h2>–ü—ñ–¥—Ç–≤–µ—Ä–¥—ñ—Ç—å –∑–º—ñ–Ω—É –ø–∞—Ä–æ–ª—è</h2>

    <label>–°—Ç–∞—Ä–∏–π –ø–∞—Ä–æ–ª—å
      <input type="password" [(ngModel)]="oldPassword" />
      <span class="error" *ngIf="passwordError === 'old'">–°—Ç–∞—Ä–∏–π –ø–∞—Ä–æ–ª—å –Ω–µ–≤—ñ—Ä–Ω–∏–π</span>
    </label>

    <label>–ù–æ–≤–∏–π –ø–∞—Ä–æ–ª—å
      <input type="password" [(ngModel)]="newPassword" />
      <span class="error" *ngIf="passwordError === 'short'">–ü–∞—Ä–æ–ª—å –º–∞—î –º—ñ—Å—Ç–∏—Ç–∏ —â–æ–Ω–∞–π–º–µ–Ω—à–µ 6 —Å–∏–º–≤–æ–ª—ñ–≤</span>
    </label>

    <label>–ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –Ω–æ–≤–æ–≥–æ
      <input type="password" [(ngModel)]="confirmPassword" />
      <span class="error" *ngIf="passwordError === 'mismatch'">–ü–∞—Ä–æ–ª—ñ –Ω–µ —Å–ø—ñ–≤–ø–∞–¥–∞—é—Ç—å</span>
    </label>

    <div class="modal-buttons">
      <button (click)="submitPasswordChange()">–ü—ñ–¥—Ç–≤–µ—Ä–¥–∏—Ç–∏</button>
      <button (click)="showPasswordChange = false">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
    </div>
  </div>
</div>
  </section>

  <section *ngIf="role === 'volunteer' || role === 'vet'" class="notifications-section">
  <h2>–ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è:</h2>

  <div *ngFor="let msg of messages" class="notification-card">
    <div class="msg-body" (click)="openAnimalForm(msg)">
      <div class="msg-title">{{ msg.title }}</div>
      <div class="msg-date">{{ msg.date }}</div>
    </div>
    <div class="msg-actions">
      <button class="accept-btn" (click)="acceptAnimal(msg)">–ü—Ä–∏–π–Ω—è—Ç–∏</button>
      <button class="reject-btn" (click)="rejectMessage(msg)">–í—ñ–¥—Ö–∏–ª–∏—Ç–∏</button>
    </div>
  </div>
</section>

  <section class="animals-section">
  <h2>–í–∞—à—ñ —Ç–≤–∞—Ä–∏–Ω–∏:</h2>
  <div *ngIf="animals.length === 0" class="no-animals-text">
    –ü—ñ–¥–ø–∏—Å—É–π—Å—è, —â–æ–± —Å—Ç–µ–∂–∏—Ç–∏ –∑–∞ —Ç–≤–∞—Ä–∏–Ω–∫–∞–º–∏ üôÇ
  </div>
  <div class="animal-grid">
    <a class="animal-card" *ngFor="let animal of animals" [routerLink]="['/animals', animal.id]">
      <img [src]="animal.image || 'assets/img/animal-default.jpg'" alt="–§–æ—Ç–æ —Ç–≤–∞—Ä–∏–Ω–∏" />
      <div class="animal-name">{{ animal.name }}</div>
    </a>
  </div>
</section>
</main>

<app-site-footer></app-site-footer>
