<section class="admin-section">
  <h2>–õ—ñ–∫—É–≤–∞–Ω–Ω—è</h2>

  <div class="filter-controls">
    <div class="filter-fields">
      <label>
        ID:
        <input [(ngModel)]="filters.id" (change)="applyFilters()" />
      </label>
      <label>
        ID —Ç–≤–∞—Ä–∏–Ω–∏:
        <input [(ngModel)]="filters.animalId" (change)="applyFilters()" />
      </label>
      <label>
        –°–æ—Ä—Ç—É–≤–∞—Ç–∏ –∑–∞:
        <select [(ngModel)]="filters.orderBy" (change)="applyFilters()">
          <option value="id">ID</option>
          <option value="created_at">–°—Ç–≤–æ—Ä–µ–Ω–æ</option>
          <option value="money_spent">–í–∏—Ç—Ä–∞—Ç–∏</option>
        </select>
      </label>
      <label>
        –ù–∞–ø—Ä—è–º–æ–∫:
        <select [(ngModel)]="filters.order" (change)="applyFilters()">
          <option value="asc">–ó—Ä–æ—Å—Ç–∞–Ω–Ω—è–º</option>
          <option value="desc">–°–ø–∞–¥–∞–Ω–Ω—è–º</option>
        </select>
      </label>
      <label>–°—Ç–∞—Ç—É—Å –≤–∏–ø–ª–∞—Ç–∏:
        <select [(ngModel)]="filters.payoutStatus" (change)="applyFilters()">
          <option value="">–£—Å—ñ</option>
          <option value="0">–ù–µ –∑–∞–ø–∏—Ç–∞–Ω–æ</option>
          <option value="1">–ó–∞–ø–∏—Ç–∞–Ω–æ</option>
          <option value="2">–£ –æ–±—Ä–æ–±—Ü—ñ</option>
          <option value="3">–í–∏–ø–ª–∞—á–µ–Ω–æ</option>
        </select>
      </label>
    </div>
    <button class="green-btn" (click)="resetFilters()">–°–∫–∏–Ω—É—Ç–∏ —Ñ—ñ–ª—å—Ç—Ä–∏</button>
  </div>

  <table class="admin-table">
    <thead>
      <tr>
        <th>ID</th>
        <th>–¢–≤–∞—Ä–∏–Ω–∞</th>
        <th>–û–ø–∏—Å</th>
        <th>–í–∏—Ç—Ä–∞—Ç–∏</th>
        <th>–í–∏–ø–ª–∞—Ç–∞</th>
        <th>–î–∞—Ç–∞</th>
        <th>–î—ñ—ó</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let t of treatments">
        <ng-container *ngIf="!filters.payoutStatus || t.payout_status.toString() === filters.payoutStatus">
        <td>{{ t.id }}</td>
        <td>{{ t?.animal_report?.animal?.name || t?.animal_report?.animal?.id || '‚Äî' }}</td>
        <td>{{ t.description }}</td>
        <td>{{ t.money_spent }} –≥—Ä–Ω</td>
        <td>{{ payoutStatusLabels[t.payout_status] }}</td>
        <td>{{ t.created_at }}</td>
        <td class="actions-cell">
          <button class="btn-save" *ngIf="t.payout_status == 1" (click)="openPayoutModal(t)">$</button>
          <button class="btn-delete" (click)="openDeleteModal(t)">üóë</button>
        </td>
        </ng-container>
      </tr>
    </tbody>
  </table>

  <div class="modal-overlay" *ngIf="treatmentToDelete">
    <div class="modal">
      <h3>–í–∏–¥–∞–ª–∏—Ç–∏ –ª—ñ–∫—É–≤–∞–Ω–Ω—è #{{ treatmentToDelete.id }}?</h3>
      <div class="modal-buttons">
        <button (click)="confirmDelete()">–í–∏–¥–∞–ª–∏—Ç–∏</button>
        <button (click)="cancelDelete()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
      </div>
    </div>
  </div>

  <div class="modal-overlay" *ngIf="treatmentToPay">
    <div class="modal">
      <h3>–í–∏–ø–ª–∞—Ç–∏—Ç–∏ –ª—ñ–∫—É–≤–∞–Ω–Ω—è #{{ treatmentToPay.id }}?</h3>
      <div class="modal-buttons">
        <button (click)="confirmPayout()" class="btn-save">–í–∏–ø–ª–∞—Ç–∏—Ç–∏</button>
        <button (click)="cancelPayout()">–°–∫–∞—Å—É–≤–∞—Ç–∏</button>
      </div>
    </div>
  </div>
</section>
